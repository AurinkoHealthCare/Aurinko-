import{r as l,a as p,j as t}from"./index-Dg0sH7Ks.js";const L=()=>{const[d,N]=l.useState([]),[v,h]=l.useState(!0),[o,b]=l.useState(null),[n,c]=l.useState(f()),[m,w]=l.useState("");function f(){return{name:"",details:"",segment:"",type:"",category:"",packing:"",composition:"",indications:"",usage:"",report:"",brochure:"",feedback:"",productImage:null,productLogo:null,translations:{fr:{},es:{},ar:{},ko:{}}}}l.useEffect(()=>{g()},[]);const g=async()=>{try{h(!0);const e=await p.get("/products2/all");N(e.data)}catch{alert("❌ Error fetching products")}finally{h(!1)}},u=e=>{const{name:s,value:a}=e.target;c(r=>({...r,[s]:a}))},I=(e,s)=>{const{name:a,value:r}=e.target;c(x=>({...x,translations:{...x.translations,[s]:{...x.translations[s],[a]:r}}}))},i=e=>{const{name:s,files:a}=e.target;a.length>0&&c(r=>({...r,[s]:a[0]}))},k=e=>{b(e),c({name:e.generalInfo?.name||"",details:e.generalInfo?.details||"",segment:e.generalInfo?.segment||"",type:e.generalInfo?.type||"",category:e.generalInfo?.category||"",packing:e.generalInfo?.packing||"",composition:e.composition||"",indications:e.indications||"",usage:e.usage||"",report:e.report||"",brochure:e.brochure||"",feedback:e.feedback||"",productImage:null,productLogo:null,translations:e.translations||{fr:{},es:{},ar:{},ko:{}}})},j=()=>{b(null),c(f())},C=async e=>{e.preventDefault();try{const s=new FormData;Object.entries(n).forEach(([a,r])=>{a==="translations"?s.append("translations",JSON.stringify(r)):(r instanceof File||typeof r=="string"&&r.trim()!=="")&&s.append(a,r)}),await p.put(`/products2/update/${o._id}`,s,{headers:{"Content-Type":"multipart/form-data"}}),alert("✅ Product updated successfully!"),j(),g()}catch(s){const a=s.response?.data?.message||"Error updating product";alert("❌ "+a)}},P=async e=>{if(window.confirm("Are you sure you want to delete this product?"))try{await p.delete(`/products2/delete/${e}`),alert("✅ Product deleted!"),g()}catch{alert("❌ Error deleting product")}},y=m?d.filter(e=>e.generalInfo?.segment===m):d,E=[...new Set(d.map(e=>e.generalInfo?.segment).filter(Boolean))];return v?t.jsx("p",{className:"text-center text-gray-600 text-sm",children:"Loading products..."}):t.jsxs("div",{className:"max-w-6xl mx-auto px-3 py-6",children:[t.jsx("h1",{className:"text-2xl font-bold text-center text-green-700 mb-6",children:"Multiple product management"}),t.jsxs("div",{className:"mb-4 flex gap-3 items-center",children:[t.jsx("label",{className:"text-sm font-medium",children:"Filter by Segment:"}),t.jsxs("select",{value:m,onChange:e=>w(e.target.value),className:"border border-gray-300 rounded px-2 py-1 text-sm",children:[t.jsx("option",{value:"",children:"All"}),E.map(e=>t.jsx("option",{value:e,children:e},e))]})]}),o&&t.jsxs("form",{onSubmit:C,className:"mb-8 bg-white p-4 rounded-lg shadow-sm border border-gray-200",children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 mb-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium",children:"Product Image"}),t.jsx("input",{type:"file",name:"productImage",onChange:i})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium",children:"Product Logo"}),t.jsx("input",{type:"file",name:"productLogo",onChange:i})]})]}),t.jsx("h2",{className:"text-lg font-semibold mb-3 text-green-800",children:"Edit Product"}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 mb-3",children:[["name","details","segment","type","category","packing","composition","indications","usage","feedback"].map(e=>t.jsxs("div",{children:[t.jsx("label",{className:"text-sm font-medium capitalize",children:e}),t.jsx("input",{type:"text",name:e,value:n[e],onChange:u,required:e==="name"||e==="category"||e==="details",className:"w-full border border-gray-300 rounded px-2 py-1 text-sm"})]},e)),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium",children:"Report"}),t.jsx("input",{type:"file",name:"report",onChange:i}),t.jsx("input",{type:"text",name:"report",placeholder:"Or enter report URL/text",value:typeof n.report=="string"?n.report:"",onChange:u,className:"w-full border border-gray-300 rounded px-2 py-1 text-sm mt-1"}),o?.report&&t.jsx("a",{href:o.report,target:"_blank",className:"text-xs text-blue-600 underline",children:"View current report"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium",children:"Brochure"}),t.jsx("input",{type:"file",name:"brochure",onChange:i}),t.jsx("input",{type:"text",name:"brochure",placeholder:"Or enter brochure URL/text",value:typeof n.brochure=="string"?n.brochure:"",onChange:u,className:"w-full border border-gray-300 rounded px-2 py-1 text-sm mt-1"}),o?.brochure&&t.jsx("a",{href:o.brochure,target:"_blank",className:"text-xs text-blue-600 underline",children:"View current brochure"})]})]}),["fr","es","ar","ko"].map(e=>t.jsxs("div",{className:"mb-4 border-t pt-3",children:[t.jsxs("h4",{className:"font-semibold text-sm mb-2",children:[e.toUpperCase()," Translation"]}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:["name","details","segment","type","category","packing","composition","indications","usage"].map(s=>t.jsxs("div",{children:[t.jsx("label",{className:"text-sm font-medium capitalize",children:s}),t.jsx("input",{type:"text",name:s,value:n.translations[e]?.[s]||"",onChange:a=>I(a,e),placeholder:`${s} (${e})`,className:"w-full border border-gray-300 rounded px-2 py-1 text-sm"})]},s))})]},e)),t.jsxs("div",{className:"flex gap-3 mt-4",children:[t.jsx("button",{type:"submit",className:"bg-green-600 text-white px-4 py-1.5 text-sm rounded hover:bg-green-700",children:"Update"}),t.jsx("button",{type:"button",onClick:j,className:"bg-gray-500 text-white px-4 py-1.5 text-sm rounded hover:bg-gray-600",children:"Cancel"})]})]}),t.jsxs("div",{className:"p-4",children:[t.jsx("h2",{className:"text-lg font-semibold mb-3",children:"All Products"}),y.length===0?t.jsx("p",{className:"text-gray-500 text-sm",children:"No products available."}):t.jsx("div",{className:"grid gap-4 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-3",children:y.map(e=>t.jsxs("div",{className:"border bg-white border-gray-300 rounded-lg p-3 shadow hover:shadow-md transition",children:[t.jsx("div",{className:"flex justify-between items-center mb-2",children:t.jsxs("span",{className:"text-xs text-gray-500 font-mono",children:["ID: ",e.productId]})}),t.jsx("div",{className:"flex flex-col items-center",children:t.jsxs("div",{className:"items-center",children:[e.productImage&&t.jsx("img",{src:e.productImage,alt:"Product",className:"object-cover h-40 m-2"}),e.productLogo&&t.jsx("img",{src:e.productLogo,alt:"Logo",className:"h-10 object-contain"})]})}),t.jsx("h3",{className:"text-base font-semibold text-gray-800 mb-1",children:e.generalInfo?.name||"-"}),t.jsxs("p",{className:"text-sm text-gray-600",children:[t.jsx("span",{className:"font-medium",children:"Category:"})," ",e.generalInfo?.category||"-"]}),t.jsxs("p",{className:"text-sm text-gray-600 mb-3",children:[t.jsx("span",{className:"font-medium",children:"Segment:"})," ",e.generalInfo?.segment||"-"]}),t.jsxs("div",{className:"flex gap-3",children:[t.jsx("button",{onClick:()=>k(e),className:"flex-1 bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Edit"}),t.jsx("button",{onClick:()=>P(e._id),className:"flex-1 bg-red-600 text-white px-4 py-2 rounded hover:bg-red-700",children:"Delete"})]})]},e._id))})]})]})};export{L as default};
